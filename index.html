//@version=5
strategy("ANAS ALKILIDAR SIGNALS | XAUUSD 1M", overlay=true, calc_on_every_tick=true, pyramiding=0, initial_capital=10000)

// ===== Inputs =====
slPoints = 1.5
tpPoints = 2.5

// ===== Indicators =====
ema9   = ta.ema(close, 9)
ema21  = ta.ema(close, 21)
ema50  = ta.ema(close, 50)
rsiVal = ta.rsi(close, 14)
[macdLine, signalLine, _] = ta.macd(close, 12, 26, 9)
upperBB, middleBB, lowerBB = ta.bb(close, 20, 2)

// ===== Entry Conditions =====
buyCond  = close > ema9 and ema9 > ema21 and ema21 > ema50 and rsiVal > 55 and macdLine > signalLine and close > middleBB
sellCond = close < ema9 and ema9 < ema21 and ema21 < ema50 and rsiVal < 45 and macdLine < signalLine and close < middleBB

// ===== Market Orders =====
if buyCond and strategy.position_size == 0
    strategy.entry("BUY", strategy.long)
    strategy.exit("BUY TP/SL", "BUY", stop=close - slPoints, limit=close + tpPoints)

if sellCond and strategy.position_size == 0
    strategy.entry("SELL", strategy.short)
    strategy.exit("SELL TP/SL", "SELL", stop=close + slPoints, limit=close - tpPoints)

// ===== Plot Levels =====
plot(ema9, color=color.orange, title="EMA 9")
plot(ema21, color=color.blue, title="EMA 21")
plot(ema50, color=color.purple, title="EMA 50")
plot(upperBB, color=color.gray, title="BB Upper")
plot(middleBB, color=color.gray, title="BB Middle")
plot(lowerBB, color=color.gray, title="BB Lower")

// ===== Labels =====
if buyCond
    label.new(bar_index, close, "BUY\nSL:"+str.tostring(close-slPoints)+"\nTP:"+str.tostring(close+tpPoints), color=color.green, textcolor=color.black, style=label.style_label_down)

if sellCond
    label.new(bar_index, close, "SELL\nSL:"+str.tostring(close+slPoints)+"\nTP:"+str.tostring(close-tpPoints), color=color.red, textcolor=color.white, style=label.style_label_up)
