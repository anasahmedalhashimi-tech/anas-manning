//@version=5
indicator("ANAS ALKILIDAR SIGNALS | XAUUSD 5M", overlay=true, calc_on_every_tick=true)

// ===== Settings =====
riskReward = 5.0
atrLen = 14
atrMult = 1.0

// ===== Indicators =====
ema20  = ta.ema(close, 20)
ema50  = ta.ema(close, 50)
ema200 = ta.ema(close, 200)
rsi    = ta.rsi(close, 14)
[macdLine, signalLine, _] = ta.macd(close, 12, 26, 9)
atr = ta.atr(atrLen)

// ===== Conditions =====
buy  = close > ema20 and ema20 > ema50 and ema50 > ema200 and rsi > 55 and macdLine > signalLine
sell = close < ema20 and ema20 < ema50 and ema50 < ema200 and rsi < 45 and macdLine < signalLine

// ===== Levels =====
var float entry = na
var float sl = na
var float tp = na

if buy
    entry := close
    sl := close - atr * atrMult
    tp := close + atr * atrMult * riskReward

if sell
    entry := close
    sl := close + atr * atrMult
    tp := close - atr * atrMult * riskReward

// ===== Plot Lines =====
plot(entry, "ENTRY", color=color.yellow, linewidth=2)
plot(sl, "SL", color=color.red, linewidth=2)
plot(tp, "TP", color=color.green, linewidth=2)

// ===== Price Labels =====
if not na(entry)
    label.new(bar_index, entry, "ENTRY: " + str.tostring(entry, format.mintick), color=color.yellow, textcolor=color.black, style=label.style_label_left)

if not na(sl)
    label.new(bar_index, sl, "SL: " + str.tostring(sl, format.mintick), color=color.red, textcolor=color.white, style=label.style_label_left)

if not na(tp)
    label.new(bar_index, tp, "TP: " + str.tostring(tp, format.mintick), color=color.green, textcolor=color.black, style=label.style_label_left)

// ===== EMA =====
plot(ema20, color=color.orange)
plot(ema50, color=color.blue)
plot(ema200, color=color.purple)
