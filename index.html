//@version=5
strategy("ANAS ALKILIDAR SIGNALS â€” XAUUSD M5", overlay=true, calc_on_every_tick=true, initial_capital=100000, default_qty_type=strategy.percent_of_equity, default_qty_value=1)

// ====== SETTINGS ======
rr = 5.0
emaFastLen = 20
emaSlowLen = 50
rsiLen = 14
atrLen = 14
atrMultSL = 1.0
sessionFilter = input.session("0000-2359", "Session")

// ====== DATA ======
inSession = time(timeframe.period, sessionFilter)
emaFast = ta.ema(close, emaFastLen)
emaSlow = ta.ema(close, emaSlowLen)
rsi = ta.rsi(close, rsiLen)
atr = ta.atr(atrLen)

// ====== TREND & MOMENTUM ======
trendUp = emaFast > emaSlow and close > emaFast
trendDn = emaFast < emaSlow and close < emaFast
momentumUp = rsi > 50 and ta.crossover(rsi, 50)
momentumDn = rsi < 50 and ta.crossunder(rsi, 50)

// ====== ENTRIES ======
longCond  = inSession and trendUp and momentumUp
shortCond = inSession and trendDn and momentumDn

// ====== RISK MANAGEMENT (1:5) ======
longSL  = close - atr * atrMultSL
longTP  = close + (atr * atrMultSL) * rr
shortSL = close + atr * atrMultSL
shortTP = close - (atr * atrMultSL) * rr

// ====== EXECUTION ======
if (longCond)
    strategy.entry("BUY", strategy.long)
    strategy.exit("BUY EXIT", "BUY", stop=longSL, limit=longTP)

if (shortCond)
    strategy.entry("SELL", strategy.short)
    strategy.exit("SELL EXIT", "SELL", stop=shortSL, limit=shortTP)

// ====== VISUALS ======
plot(emaFast, color=color.new(color.green, 0), linewidth=2)
plot(emaSlow, color=color.new(color.red, 0), linewidth=2)
plotshape(longCond, title="BUY SIGNAL", style=shape.triangleup, location=location.belowbar, color=color.lime, size=size.small, text="BUY")
plotshape(shortCond, title="SELL SIGNAL", style=shape.triangledown, location=location.abovebar, color=color.red, size=size.small, text="SELL")

// ====== ALERTS ======
alertcondition(longCond, title="BUY ALERT", message="ANAS ALKILIDAR SIGNALS | BUY XAUUSD M5 | SL={{plot(\"longSL\")}} TP={{plot(\"longTP\")}}")
alertcondition(shortCond, title="SELL ALERT", message="ANAS ALKILIDAR SIGNALS | SELL XAUUSD M5 | SL={{plot(\"shortSL\")}} TP={{plot(\"shortTP\")}}")
